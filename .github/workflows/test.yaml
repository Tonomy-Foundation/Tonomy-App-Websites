name: Test - build, test and lint

on: push

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Enable Corepack before setting up Node
        run: corepack enable

     - name: Set Environment Variable Based on Branch
        run: echo "VITE_APP_NODE_ENV=$(if [[ ${{ github.ref_name }} == 'master' ]]; then echo 'production'; elif [[ ${{ github.ref_name }} == 'development' ]]; then echo 'staging'; elif [[ ${{ github.ref_name }} == 'testnet' ]]; then echo 'testnet'; else echo 'development'; fi)" >> $GITHUB_ENV


      - name: ðŸš€ Build app
        env:
          VITE_APP_NODE_ENV: ${{ env.VITE_APP_NODE_ENV }}
        uses: actions/setup-node@v4
        with:
          node-version: 22.3.0
      - run: yarn install --immutable
      - run: yarn run build
      # TODO: fix linting
      # - run: yarn run lint

